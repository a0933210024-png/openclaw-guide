---
import Layout from '../../layouts/Layout.astro';
---

<Layout 
  title="AI æ–°èä¸­å¿ƒ â€” MiniBot" 
  lang="zh" 
  currentPath="/news" 
  description="æ¯æ—¥æ›´æ–° AI ç”¢æ¥­å‹•æ…‹ã€æ¨¡å‹ç™¼å¸ƒã€èè³‡æ¶ˆæ¯ã€‚ä¸­è‹±é›™èªæ‘˜è¦ï¼ŒæŒæ¡ AI è¶¨å‹¢è„ˆå‹•ã€‚"
>
  <!-- Page Header -->
  <section class="page-header">
    <div class="container">
      <h1>ğŸ“° AI æ–°èä¸­å¿ƒ</h1>
      <p>æ¯æ—¥æ›´æ–° AI ç”¢æ¥­å‹•æ…‹ Â· ä¸­è‹±é›™èªæ‘˜è¦</p>
    </div>
  </section>

  <!-- Filter Bar -->
  <section class="filter-bar">
    <button class="filter-tab active" data-category="all">å…¨éƒ¨</button>
    <button class="filter-tab" data-category="æ¨¡å‹ç™¼å¸ƒ">æ¨¡å‹ç™¼å¸ƒ</button>
    <button class="filter-tab" data-category="èè³‡å‹•æ…‹">èè³‡å‹•æ…‹</button>
    <button class="filter-tab" data-category="æŠ€è¡“çªç ´">æŠ€è¡“çªç ´</button>
    <button class="filter-tab" data-category="æ”¿ç­–ç›£ç®¡">æ”¿ç­–ç›£ç®¡</button>
    <button class="filter-tab" data-category="ç”¢æ¥­å‹•æ…‹">ç”¢æ¥­å‹•æ…‹</button>
  </section>

  <!-- News Layout -->
  <section class="news-container">
    <div class="news-main">
      <!-- Left: News List -->
      <div class="news-list" id="news-list">
        <div class="loading-message" id="loading">
          <div class="spinner"></div>
          <p>è¼‰å…¥æ–°èä¸­...</p>
        </div>
        
        <div class="empty-state" id="empty-state" style="display: none;">
          <div class="empty-icon">ğŸ“°</div>
          <h3>æ–°èç³»çµ±åˆå§‹åŒ–ä¸­</h3>
          <p>å³å°‡æ›´æ–°æœ€æ–° AI ç”¢æ¥­è³‡è¨Š...</p>
        </div>
      </div>
      
      <!-- Right: Sidebar -->
      <aside class="news-sidebar">
        <div class="sidebar-card">
          <h3>ğŸ”¥ ä»Šæ—¥ç†±é–€è©±é¡Œ</h3>
          <div class="topic-tags" id="topic-tags">
            <span class="topic-tag">GPT-5</span>
            <span class="topic-tag">Claude 3.5</span>
            <span class="topic-tag">AI ç›£ç®¡</span>
            <span class="topic-tag">é–‹æºæ¨¡å‹</span>
            <span class="topic-tag">AI æ™¶ç‰‡</span>
          </div>
        </div>
        
        <div class="sidebar-card">
          <h3>ğŸ“Š è³‡æ–™ä¾†æº</h3>
          <ul class="source-list">
            <li>TechCrunch</li>
            <li>The Information</li>
            <li>Bloomberg</li>
            <li>VentureBeat</li>
            <li>Anthropic Blog</li>
            <li>OpenAI Blog</li>
          </ul>
        </div>
      </aside>
    </div>
  </section>

  <script is:inline>
    let allArticles = [];
    let currentCategory = 'all';
    
    // Demo articles (fallback)
    const demoArticles = [
      {
        titleZh: "Anthropic æ¨å‡º Enterprise ç‰ˆ Claudeï¼Œæ”¯æ´ç™¾è¬ Token é•·ä¸Šä¸‹æ–‡",
        title: "Anthropic Launches Enterprise Claude with Million-Token Context",
        summaryZh: "Anthropic å®£å¸ƒæ¨å‡ºä¼æ¥­ç‰ˆ Claudeï¼Œæ“´å±•ä¸Šä¸‹æ–‡çª—å£æ”¯æŒå¤§è¦æ¨¡å•†æ¥­æ‡‰ç”¨ã€‚",
        summary: "Anthropic announced Enterprise Claude with expanded context window support for large-scale business applications.",
        url: "https://www.anthropic.com/news",
        source: "Anthropic Blog",
        category: "æ¨¡å‹ç™¼å¸ƒ",
        publishedAt: "2026-02-25T10:00:00Z"
      },
      {
        titleZh: "OpenAI GPT-5 å³å°‡ç™¼å¸ƒï¼Œæ“šå‚³æ¨ç†èƒ½åŠ›å¤§èºé€²",
        title: "OpenAI GPT-5 Launch Imminent, Reasoning Leap Expected",
        summaryZh: "å ±å°æŒ‡å‡º OpenAI çš„ GPT-5 å°‡å…·å‚™é¡¯è‘—æ”¹å–„çš„æ¨ç†èƒ½åŠ›ï¼Œå°‡åœ¨æ•¸é€±å…§æ¨å‡ºã€‚",
        summary: "Reports suggest OpenAI's GPT-5 will feature significantly improved reasoning capabilities, launching within weeks.",
        url: "https://www.theinformation.com",
        source: "The Information",
        category: "æ¨¡å‹ç™¼å¸ƒ",
        publishedAt: "2026-02-24T14:30:00Z"
      },
      {
        titleZh: "Nvidia å¸‚å€¼çªç ´ $4 å…†ï¼Œæˆå²ä¸Šæœ€é«˜å¸‚å€¼å…¬å¸",
        title: "Nvidia Market Cap Surpasses $4 Trillion, Highest Ever",
        summaryZh: "å— AI æ™¶ç‰‡éœ€æ±‚æ¿€å¢æ¨å‹•ï¼ŒNvidia å¸‚å€¼é”åˆ°æ­·å²æ€§çš„ 4 å…†ç¾å…ƒã€‚",
        summary: "Nvidia's market capitalization reached a historic $4 trillion, driven by surging AI chip demand.",
        url: "https://www.bloomberg.com",
        source: "Bloomberg",
        category: "ç”¢æ¥­å‹•æ…‹",
        publishedAt: "2026-02-23T16:00:00Z"
      }
    ];
    
    function formatTimeAgo(dateString) {
      const date = new Date(dateString);
      const now = new Date();
      const diffMs = now - date;
      const diffHours = Math.floor(diffMs / (1000 * 60 * 60));
      const diffDays = Math.floor(diffHours / 24);
      
      if (diffHours < 1) return 'å‰›å‰›';
      if (diffHours < 24) return `${diffHours}h`;
      if (diffDays < 7) return `${diffDays}d`;
      return date.toLocaleDateString('zh-TW', { month: 'short', day: 'numeric' });
    }
    
    function getCategoryColor(category) {
      const colors = {
        'æ¨¡å‹ç™¼å¸ƒ': '#4fc3f7',
        'èè³‡å‹•æ…‹': '#30d158',
        'æŠ€è¡“çªç ´': '#ffd60a',
        'æ”¿ç­–ç›£ç®¡': '#ff453a',
        'ç”¢æ¥­å‹•æ…‹': '#bf5af2'
      };
      return colors[category] || '#6b6b72';
    }
    
    function renderArticles(articles) {
      const list = document.getElementById('news-list');
      const loading = document.getElementById('loading');
      const emptyState = document.getElementById('empty-state');
      
      if (loading) loading.style.display = 'none';
      
      if (articles.length === 0) {
        emptyState.style.display = 'flex';
        return;
      }
      
      emptyState.style.display = 'none';
      
      const html = articles.map(article => {
        const categoryColor = getCategoryColor(article.category);
        return `
          <a href="${article.url}" target="_blank" rel="noopener noreferrer" class="news-item">
            <div class="news-item-left">
              <div class="news-category-dot" style="background: ${categoryColor}"></div>
              <div>
                <h3 class="news-item-title">${article.titleZh || article.title}</h3>
                <div class="news-item-meta">
                  <span class="news-source-badge">${article.source}</span>
                  <span>Â·</span>
                  <span class="news-item-time mono">${formatTimeAgo(article.publishedAt)}</span>
                </div>
              </div>
            </div>
          </a>
        `;
      }).join('');
      
      list.innerHTML = html;
    }
    
    function filterArticles(category) {
      currentCategory = category;
      const filtered = category === 'all' 
        ? allArticles 
        : allArticles.filter(a => a.category === category);
      renderArticles(filtered);
    }
    
    async function loadNews() {
      try {
        const res = await fetch('/news.json');
        
        if (!res.ok) {
          allArticles = demoArticles;
          renderArticles(allArticles);
          return;
        }
        
        const data = await res.json();
        
        if (!data.articles || data.articles.length === 0) {
          allArticles = demoArticles;
        } else {
          allArticles = data.articles;
        }
        
        renderArticles(allArticles);
        
      } catch (error) {
        console.error('Failed to load news:', error);
        allArticles = demoArticles;
        renderArticles(allArticles);
      }
    }
    
    // Filter tabs functionality
    document.addEventListener('DOMContentLoaded', () => {
      const filterTabs = document.querySelectorAll('.filter-tab');
      
      filterTabs.forEach(tab => {
        tab.addEventListener('click', () => {
          filterTabs.forEach(t => t.classList.remove('active'));
          tab.classList.add('active');
          
          const category = tab.getAttribute('data-category');
          filterArticles(category);
        });
      });
      
      loadNews();
    });
  </script>

  <style>
    /* Page Header */
    .page-header {
      padding: 48px 0 32px;
      border-bottom: 1px solid var(--border);
    }

    .page-header h1 {
      font-size: 36px;
      font-weight: 700;
      letter-spacing: -0.03em;
      margin: 0 0 8px;
    }

    .page-header p {
      color: var(--text2);
      font-size: 16px;
      margin: 0;
    }

    /* Filter Bar */
    .filter-bar {
      display: flex;
      gap: 0;
      border-bottom: 1px solid var(--border);
      overflow-x: auto;
    }

    .filter-tab {
      padding: 12px 20px;
      font-size: 13px;
      font-weight: 600;
      color: var(--text2);
      background: none;
      border: none;
      border-bottom: 2px solid transparent;
      cursor: pointer;
      transition: all 0.15s;
      white-space: nowrap;
      font-family: var(--font);
    }

    .filter-tab:hover {
      color: var(--text);
    }

    .filter-tab.active {
      color: var(--accent-bright);
      border-bottom-color: var(--accent-bright);
    }

    /* News Container */
    .news-container {
      max-width: var(--max-width);
      margin: 0 auto;
      padding: 0;
    }

    .news-main {
      display: grid;
      grid-template-columns: 1fr 340px;
      gap: 0;
      border-left: 1px solid var(--border);
      border-right: 1px solid var(--border);
    }

    /* News List */
    .news-list {
      border-right: 1px solid var(--border);
    }

    .loading-message {
      text-align: center;
      padding: 60px 20px;
    }

    .spinner {
      width: 32px;
      height: 32px;
      border: 3px solid var(--border);
      border-top-color: var(--accent-bright);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
      margin: 0 auto 16px;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .empty-state {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 80px 20px;
    }

    .empty-icon {
      font-size: 64px;
      margin-bottom: 16px;
    }

    .empty-state h3 {
      font-size: 20px;
      margin: 0 0 8px;
      color: var(--text);
    }

    .empty-state p {
      color: var(--text2);
      margin: 0;
      font-size: 14px;
    }

    .news-item {
      padding: 20px 24px;
      border-bottom: 1px solid var(--border);
      display: block;
      cursor: pointer;
      text-decoration: none;
      color: var(--text);
      transition: background 0.15s;
    }

    .news-item:hover {
      background: var(--bg2);
    }

    .news-item-left {
      display: flex;
      gap: 12px;
      align-items: start;
    }

    .news-category-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      flex-shrink: 0;
      margin-top: 6px;
    }

    .news-item-title {
      font-size: 15px;
      font-weight: 600;
      line-height: 1.4;
      color: var(--text);
      margin: 0 0 6px;
    }

    .news-item-meta {
      display: flex;
      gap: 8px;
      align-items: center;
      font-size: 12px;
      color: var(--text3);
    }

    .news-source-badge {
      font-weight: 600;
      color: var(--text2);
    }

    .news-item-time {
      font-variant-numeric: tabular-nums;
    }

    /* Sidebar */
    .news-sidebar {
      padding: 24px;
      background: var(--bg);
      display: flex;
      flex-direction: column;
      gap: 24px;
    }

    .sidebar-card h3 {
      font-size: 14px;
      font-weight: 700;
      margin: 0 0 16px;
      color: var(--text);
    }

    .topic-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .topic-tag {
      background: rgba(79, 195, 247, 0.15);
      color: var(--accent-bright);
      border: 1px solid rgba(79, 195, 247, 0.3);
      padding: 6px 12px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 600;
    }

    .source-list {
      list-style: none;
      padding: 0;
      margin: 0;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .source-list li {
      font-size: 13px;
      color: var(--text2);
      padding-left: 16px;
      position: relative;
    }

    .source-list li::before {
      content: "â€¢";
      position: absolute;
      left: 0;
      color: var(--accent-bright);
      font-weight: bold;
    }

    @media (max-width: 1024px) {
      .news-main {
        grid-template-columns: 1fr;
      }

      .news-sidebar {
        order: -1;
        border-bottom: 1px solid var(--border);
      }

      .news-list {
        border-right: none;
      }
    }

    @media (max-width: 768px) {
      .page-header h1 {
        font-size: 28px;
      }

      .news-main {
        border-left: none;
        border-right: none;
      }

      .filter-bar {
        overflow-x: scroll;
      }
    }
  </style>
</Layout>
